<div class="dashboard-bg">
  <div class="dashboard-bg-filter"></div>
  <img src="/assets/images/cesped.png" alt="Fondo" class="dashboard-bg-img" />
</div>

<div class="dashboard-container">
  <div class="dashboard-card">
    <div class="dashboard-header">
      <h1 class="dashboard-title">
        <svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
        </svg>
        Jugadores Cláusulados 
      </h1>
      <p class="dashboard-subtitle">Jugadores temporada 2025/2026</p>
    </div>
    
    <div class="search-section">
      <div class="search-field">
        <input
          type="text"
          [(ngModel)]="searchTerm"
          (keyup.enter)="search()"
          placeholder="Buscar por nombre..."
          class="search-input"
        />
      </div>
      
      <div class="search-actions">
        <button 
          class="btn btn-primary"
          (click)="search()"
          [disabled]="isLoading"
        >
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
            <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
          </svg>
          Buscar
        </button>
        
        <button 
          class="btn btn-secondary"
          (click)="clearSearch()"
          [disabled]="isLoading"
        >
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
            <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
          </svg>
          Limpiar
        </button>
        
        
        <button *ngIf="isAdmin"
          class="btn btn-accent"
          (click)="openCreatePlayerModal()"
          [disabled]="isLoading"
        >
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
            <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
          </svg>
          Crear Jugador
        </button>
      </div>
    </div>

    <div *ngIf="errorMessage" class="error-message">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
      </svg>
      {{ errorMessage }}
    </div>

    <div *ngIf="isLoading" class="loading-container">
      <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor" class="loading-icon">
        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"/>
      </svg>
      <p>Cargando jugadores...</p>
    </div>

    <div *ngIf="!isLoading && players.length === 0" class="empty-state">
      <svg width="64" height="64" viewBox="0 0 24 24" fill="currentColor" class="empty-state-icon">
        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
      </svg>
      <h3>No hay jugadores</h3>
      <p>No se encontraron jugadores. Intenta crear uno nuevo.</p>
      <button 
        class="btn btn-primary"
        (click)="openCreatePlayerModal()"
      >
        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
          <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
        </svg>
        Crear Primer Jugador
      </button>
    </div>

    <div *ngIf="!isLoading && players.length > 0" class="player-grid">
      <div *ngFor="let player of players" class="player-card">
        <div class="container-button">
          <button *ngIf="isAdmin" (click)="deletePlayer(player.id)" class="btn btn-danger">X</button>
          <button *ngIf="isAdmin" (click)="increaseNumbClau(player)" class=" btn btn-update btn-warning ">+</button>
        </div>
        <div class="player-image">
          <img 
            [src]="player.image ? 'data:image/jpeg;base64,' + player.image : 'assets/images/default.webp'" 
            [alt]="player.name + ' ' + player.lastname"
            (error)="handleImageError($event)"
          />
        </div>
        <div class="player-info">
          <h3>{{ player.name }} {{ player.lastname }}</h3>
          <p class="player-number">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="player-number-icon">
              <path d="M21.41 11.58l-9-9C12.05 2.22 11.55 2 11 2H4c-1.1 0-2 .9-2 2v7c0 .55.22 1.05.59 1.42l9 9c.36.36.86.58 1.41.58.55 0 1.05-.22 1.41-.59l7-7c.37-.36.59-.86.59-1.41 0-.55-.23-1.06-.59-1.42zM5.5 7C4.67 7 4 6.33 4 5.5S4.67 4 5.5 4 7 4.67 7 5.5 6.33 7 5.5 7z"/>
            </svg>
            <strong>Número Clausulazos:</strong> {{ player.numberClau }}
          </p>
          <p class="player-date">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="player-date-icon">
              <path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"/>
            </svg>
            <strong>Fecha:</strong> {{ player.date | date:'mediumDate' }}
          </p>
        </div>
      </div>
    </div>
  </div>
</div>

<app-confirm 
  *ngIf="showConfirm"
  [message]="confirmMessage"
  (confirmed)="onConfirmResponse($event)">
</app-confirm>
<app-alert *ngIf="showAlert" [message]="alertMessage"></app-alert>
